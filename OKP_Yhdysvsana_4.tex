\documentclass{tktltiki}

\usepackage[pdftex]{graphicx}
\usepackage{subfigure}
\usepackage{url}
\usepackage{amsmath}
\usepackage{comment}
\usepackage{caption}

\begin{document}
%\doublespacing
%\singlespacing
\onehalfspacing

\title{COBOL ja Python: Datan kapselointi}
\author{Erkki Heino, Tero Huomo, Eeva Terkki}
\date{\today}

\maketitle


\mytableofcontents

\section{COBOL}

\subsection{Perinteinen COBOL}

COBOLissa tietoa voidaan ryhmitell‰ muodostamalla tietueita (record) ja ryhmi‰ (group). \verb+DATA DIVISION+ -osiossa k‰ytett‰v‰t muuttujien tasonumerot (level number) m‰‰ritt‰v‰t, mink‰laisia kokonaisuuksia muuttujat muodostavat. Seuraavassa esimerkiss‰ on kuvattu opiskelijatietue.

\begin{samepage}
\begin{verbatim}
    DATA DIVISION.
    WORKING-STORAGE SECTION.
    01 OPISKELIJA.
       05 NIMI.
           10 ETUNIMI  PIC A(10).
           10 SUKUNIMI PIC A(10).
       05 NUMERO       PIC 9(10).
       05 SUKUPUOLI    PIC A.
           88 MIES     VALUE "M".
           88 NAINEN   VALUE "N".
\end{verbatim}
\end{samepage}

\verb+OPISKELIJA+ on tietue, joka koostuu nimest‰, opiskelijanumerosta ja sukupuolesta. Nimi on jaettu kahteen osaan: etunimi ja sukunimi.

Tasonumerot kuvaavat tiedon hierarkian, mutta tietyill‰ numeroilla on erityismerkitys. Hierarkiaa kuvaavat tasonumerot 02-49. Tasonumero 01 tarkoittaa, ett‰ kyseess‰ on tietue. Merkitsem‰ll‰ tasonumeroksi 66 voidaan edelt‰v‰lle muuttujalle antaa toinen nimi. 77 kuvaa muuttujaa, joka ei ole osa mit‰‰n rakennetta. Tason 88 avulla voidaan m‰‰ritt‰‰ muuttujaan liittyvi‰ ehtoja: yll‰ olevassa esimerkiss‰ opiskelijan sukupuoli on mies, jos muuttujan \verb+SUKUPUOLI+ arvo on M, ja nainen, jos arvo on N \cite[s. I-84]{ansicobol74}. Esimerkiksi voitaisiin tarkistaa, onko opiskelija mies:

\verb+IF MIES OF OPISKELIJA+

Todellisuudessa tietue ei ole juuri muuta kuin merkkijono, jonka eri osat kuvaavat tietueen kentti‰. Tietueelle voidan antaa arvot kentt‰ kerrallaan:

\verb+MOVE "ARTO" TO ETUNIMI OF OPISKELIJA.+

Toisaalta koko tietueelle voidaan antaa arvo kerralla:

\verb+MOVE "ARTO      WIKLA     1234567890M" TO OPISKELIJA.+

Esimerkin tietue sis‰lt‰‰ kerrallaan yhden opiskelijan tiedon --- t‰llaisenaan koodissa ei siis voida k‰sitell‰ useampaa opiskelijaa samanaikaisesti. Rakenne voidaan m‰‰ritell‰ taulukoksi (table), jolloin samaa rakennetta voidaan k‰ytt‰‰ useamman samanrakenteisen tiedon k‰sittelemiseen ilman saman rakenteen uudelleenm‰‰rittely‰.

Muuttuja m‰‰ritell‰‰n taulukoksi \verb+OCCURS+-lauseen avulla. \verb+OPISKELIJA+ voitaisiin muuttaa taulukoksi muokkaamalla m‰‰rittely‰ seuraavasti:
\begin{verbatim}
01 OPISKELIJA OCCURS 5 TIMES.
\end{verbatim}
Esimerkiksi taulukon toiseen opiskelijaan viitattaisiin indeksill‰ 2: \verb+OPISKELIJA(2)+. Taulukon sis‰ll‰ voidaan myˆs m‰‰ritell‰ sis‰kk‰isi‰ taulukoita.

\subsection{COBOLin oliolaajennus}

COBOL ei alunperin ole olio-ohjelmointikieli. COBOLista on kuitenkin kehitetty olio-ohjelmoinnin mahdollistava laajennus, Object-oriented COBOL. Ensimm‰iset oliolaajennukset COBOLiin tehtiin jo vuonna 1997 \cite{wikipediacobol}. Kielt‰ laajensivat esimerkiksi Micro Focus sek‰ IBM. Lopullinen ISO standardi Object-Oriented COBOLille tehtiin vuonna 2002.

Object-Oriented COBOL (jatkossa OO COBOL) lis‰‰ kieleen kolme olio-ohjelmointikielen perustavanlaatuista ominaisuutta - tiedon kapseloinnin, perinn‰n sek‰ polymorfismin. Olio-ohjelmoinnin lis‰yksien syntaksi sek‰ tarjotut ominaisuudet vaihtelevat suuresti eri toteuttajien v‰lill‰. Niiden yhten‰isyys vuoden 2002 ISO standardin kanssa on vaihteleva.

Olio-laajennoksen t‰rkeimpi‰ lis‰yksi‰ on mahdollisuus luokkien ja olioiden m‰‰rittelyyn. Kuten normaali COBOL-ohjelma, luokka m‰‰ritell‰‰n nelj‰n \textit{osion} (division) avulla. IBM'n toteutus \cite{ibmcobol} ja Micro Focus'n toteutus \cite{mfcobol} vastaavat pitk‰lti toisiaan. \verb+IDENTIFICATION DIVISION+-osiossa ohjelman tunnuksen sijasta annetaan luokan tunnus, \verb+CLASS ID+, sek‰ mahdolliset periytymisest‰ kertovat tiedot. Luokan yhteinen tietosis‰ltˆ ja metodit luetellaan \verb+FACTORY+-osiossa, olioiden tietosis‰ltˆ ja metodit \verb+OBJECT+-osiossa. Muihin luokkiin viittaamiseen on varattu erillinen \verb+REPOSITORY+-osio.

Olioiden metodien kutsumiseksi on OO COBOLiin lis‰tty avainsana \verb+INVOKE+.

\begin{verbatim}
INVOKE ARTONTILI "TALLETA" USING KATEINEN RETURNING KUITTI
\end{verbatim}

Esimerkiss‰ kutstutaan olion \verb+ARTONTILI+ metodia \verb+TALLETA+, jolle annetaan parametriksi muuttujan \verb+KATEINEN+ arvo. Metodin palauttama arvo sijoitetaan muuttujaan \verb+KUITTI+.

Periminen ja rajapintojen toteutus vaihtelee runsaasti. Micro Focus'n Visual COBOL ei mahdollista moniperint‰‰, mutta luokat voivat toteuttaa Javan tyyliin usean rajapinnan \cite{mfcobol}. IBM:n Enterprise COBOL ei m‰‰rittele dokumentoinnissa rajapintoja lainkaan, mutta est‰‰ moniperinn‰n \cite{ibmcobol}. Michael Kastenin \cite{kasten} mukaan C++:n tavoin IBM:n OO COBOL kuitenkin  luettelisi erilaisia s‰‰ntˆj‰, joilla usean luokan yht‰aikaista perimisest‰ kumpuava niin kutsuttu timanttiongelma ratkaistaan. T‰st‰ voidaan p‰‰tell‰, ett‰ OO COBOL on myˆs tukenut moniperint‰‰. Myˆs Micro Focus'n varhainen dokumentaatio mainitsee moniperinn‰n tuen \cite{mfcobolold}.

\section{Python}

Pythonissa muuttujien arvot ovat viitteit‰ olioihin, ja kaikki esitet‰‰n olioina tai olioiden v‰lisin‰ suhteina \cite{}. 

\subsection{Rakenteiset tyypit}
Pythonin tarjoamia sekvenssityyppej‰ ovat muun muassa lista (list) ja monikko (tuple). Muita kielen tietorakenteita ovat esimerkiksi joukko (set) ja hajautustaulu (dictionary).
 
\textit{Listan} alkiot erotellaan pilkuilla ja lista ymp‰rˆid‰‰n hakasuluilla. Listan alkioiden ei tarvitse olla kesken‰‰n samaa tyyppi‰ \cite{lists}. Listan sis‰ltˆ on muokattavissa sen luomisen j‰lkeen.

Pythonissa on myˆs funktionaaliselle ohjelmoinnille tyypillisi‰ funktioita, jotka ovat hyˆdyllisi‰ listojen k‰sittelyss‰: \verb+map+, \verb+filter+ ja \verb+reduce+. Listakomprehensioilla (list comprehension) voidaan 

\textit{Monikkoa} ymp‰rˆiv‰t kaarisulut, ja alkiot erotellaan toisistaan pilkuilla. Toisin kuin listan tapauksessa, kerran luotua monikkoa ei voi muokata \cite{data}. Monikko voi kuitenkin sis‰lt‰‰ muuttuvia tietotyyppej‰, kuten listoja. Monikon sis‰ll‰ voi myˆs olla toisia monikkoja.

Seuraavassa esimerkiss‰ puretaan monikko:

\begin{verbatim}
>>> monikko = ("a", 123, 3.14)
>>> x, y, z = monikko
>>> x
"a"
>>> y
123
>>> z
3.14
\end{verbatim}

Joukko on j‰rjest‰m‰tˆn tietorakenne, ja se voi sis‰lt‰‰ saman alkion korkeintaan kerran. Joukkojen k‰sittelemiseen k‰ytˆss‰ ovat matemaattiset joukko-operaatiot, kuten yhdiste, leikkaus ja erotus. Python tukee myˆs joukkokomprehensioita (set comprehension), jotka toimivat listakomprehensioiden tapaan: 

\begin{verbatim}
>>> joukko = {x for x in "nakkivanukas" if x not in "aeiouy‰ˆ"}
>>> joukko
set(['k', 'v', 's', 'n'])
\end{verbatim}

Esimerkiss‰ luodaan joukko, joka sis‰lt‰‰ merkkijonon \verb+nakkivanukas+ ne merkit, jotka eiv‰t ole pieni‰ vokaaleja. Kukin merkki esiintyy joukossa vain kerran.

\subsection{Oliot ja luokat}

Ennen versiota 2.2 Pythonin luokat erosivat hieman nykyisist‰ luokista. Itse asiassa vanhanmalliset luokat olivat k‰ytˆss‰ rinnakkain uudenmallisten luokkien kanssa Python 3:een asti \cite{python2ref}. Seuraavassa k‰sitell‰‰n uudenmallisia luokkia, ellei toisin mainita.

Python on dynaaminen kieli ja sen oliot ovat hyvin joustavia. Luokka m‰‰ritell‰‰n seuraavalla tavalla:

\begin{verbatim}
class Luokka(object):
    def __init__(self, parametri):
        self.muuttuja = parametri
\end{verbatim}

Yll‰ olevan esimerkin luokassa on m‰‰ritelty myˆs konstrukorinomainen \verb+__init__+-metodi. T‰t‰ metodia kutsutaan olion luomisen yhteydess‰. Esimerkin luokasta luotaisiin instanssi seuraavalla tavalla: \verb+l = Luokka("arvo")+. Parametreille ja muuttujille ei m‰‰ritet‰ tyyppi‰, joten esimerkinkin metodi hyv‰ksyy mink‰ tyyppisen muuttujan tahansa --- t‰ss‰ tapauksessa merkkijonon. \verb+__init__+metodia ei kuitenkaan vaadita luokan m‰‰rittelyss‰.

Muuttujille ja metodeille ei voi m‰‰ritt‰‰ n‰kyvyysalueita: kaikki luokan muuttujat ja metodit ovat k‰ytett‰viss‰ kaikkialla, miss‰ luokka on k‰ytett‰viss‰. Konvention mukaan muuttujat ja metodit, joita ei ole tarkoitettu k‰ytett‰v‰ksi luokan ulkopuolella, nimet‰‰n siten, ett‰ ne alkavat alaviivalla. T‰m‰ ei kuitenkaan est‰ niiden k‰yttˆ‰.

Olion muuttujat sijaitsevat assosiaatiotaulussa. 

- x.y() = X.y(x)

\subsection{Periytyminen}

Python tukee moniperint‰‰. 

- yl‰luokan init pit‰‰ kutsua eksplisiittisesti

\section{Etuja ja haittoja}


\newpage
 
\bibliographystyle{tktl}
\bibliography{lahteet}

\lastpage

\appendices

\pagestyle{empty}

%\internalappendix{1}{Malli ABC}

\end{document}